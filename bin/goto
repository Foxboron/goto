#!/bin/bash

PROJECT=`cat ${HOME}/.goto/active-project`
PROJECTFILE="${HOME}/.goto/projects/${PROJECT}.json"
GOTO="/usr/local/opt/goto/the_real_goto.py"

# Special case 1 (goto cd <magicword>)
if [ "$1" = "cd" ]; then
	# hack to cd in this shell to the ouput of goto show <magicword>
	path=`goto show "$2"`
	cd "$path"
    return 0
fi


# Special case 2  (goto <magicword>)
if [ "$#" -eq 1 ]; then

    # if run like: goto <magicword> 
    path=$(goto show "$1")

    # if path is folder, cd to folder
    if [ -d "$path" ]; then
        cd "$path"
        return 0

    # if path is file, open file
    elif [ -f "$path" ]; then
        goto -f "$1"
        return 0
    fi
fi

# General case
python "$GOTO" "$PROJECTFILE" "$@"
